\begin{lstlisting}[style=scalaioScala]
def treeSplitRte(leaves:Int, pivot:Int => Int):Rte =
  if (leaves == 1)
    randElement(inhabitedLeaves)
  else {
    val leftSize = pivot(leaves)  // choose 1 <= N < leaves

    lazy val left  = treeSplitRte(leftSize, pivot)
    lazy val right = treeSplitRte(leaves - leftSize, pivot)
    lazy val mid   = treeSplitRte(leaves, pivot)

    weightedCase((20, () => Cat(left, right)),
                 (30, () => And(left,right)),
                 (30, () => Or(left,right)),
                 (5,  () => Star(mid)),
                 (15, () => Not(mid)))}
\end{lstlisting}
